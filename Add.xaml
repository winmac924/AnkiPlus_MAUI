<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AnkiPlus_MAUI.Add"
             xmlns:skia="clr-namespace:SkiaSharp.Views.Maui.Controls;assembly=SkiaSharp.Views.Maui.Controls"
             Title="カードの追加">

        <VerticalStackLayout Padding="20"
                             Spacing="20">

                <!-- カードタイプ選択（ドロップダウン） -->
                <Picker x:Name="CardTypePicker"
                        Title="カードタイプを選択"
                        SelectedIndexChanged="OnCardTypeChanged">
                        <Picker.ItemsSource>
                                <x:Array Type="{x:Type x:String}">
                                        <x:String>基本・穴埋め</x:String>
                                        <x:String>選択肢</x:String>
                                        <x:String>画像穴埋め</x:String>
                                </x:Array>
                        </Picker.ItemsSource>
                </Picker>

                <!-- 基本・穴埋めカード入力（表・裏） -->
                <VerticalStackLayout x:Name="BasicCardLayout">
                        <HorizontalStackLayout>
                                <Label Text="表面"
                                       FontSize="18"/>
                                <!-- 画像挿入ボタン -->
                                <Button Text="画像を追加"
                                        Clicked="FrontOnAddImageClicked"/>
                        </HorizontalStackLayout>
                        <Editor x:Name="FrontTextEditor"
                                HeightRequest="100"
                                Placeholder="表面の内容を入力"
                                TextChanged="FrontOnTextChanged"/>
                        <Label Text="プレビュー"
                               FontSize="18"/>
                        <WebView x:Name="FrontPreviewWebView"
                                 HeightRequest="100"/>
                        <HorizontalStackLayout>
                                <Label Text="裏面"
                                       FontSize="18"/>
                                <!-- 画像挿入ボタン -->
                                <Button Text="画像を追加"
                                        Clicked="BackOnAddImageClicked"/>
                        </HorizontalStackLayout>
                        <Editor x:Name="BackTextEditor"
                                HeightRequest="100"
                                Placeholder="Markdown 記法で装飾できます"
                                TextChanged="BackOnTextChanged"/>
                        <Label Text="プレビュー"
                               FontSize="18"/>
                        <WebView x:Name="BackPreviewWebView"
                                 HeightRequest="100"/>
                </VerticalStackLayout>

                <!-- 選択肢カード入力 -->
                <StackLayout x:Name="MultipleChoiceLayout"
                             IsVisible="False">
                        <Label Text="選択肢問題"
                               FontSize="18"/>
                        <Editor x:Name="ChoiceQuestion"
                                HeightRequest="100"
                                Placeholder="問題の内容を入力"/>
                        <HorizontalStackLayout>
                                <Button Text="選択肢を追加"
                                        Clicked="OnAddChoice"/>
                                <Label Text="番号を削除"
                                       VerticalOptions="Center"
                                       Margin="10,0,0,0"/>
                                <Switch x:Name="RemoveNumbersSwitch"
                                        Toggled="OnRemoveNumbersToggled"
                                        VerticalOptions="Center"/>
                        </HorizontalStackLayout>
                        <StackLayout x:Name="ChoicesContainer"/>
                        <Label Text="解説"
                               FontSize="18"/>
                        <Editor x:Name="ChoiceQuestionExplanation"
                                HeightRequest="100"
                                Placeholder="解説の内容を入力"/>
                </StackLayout>

                <!-- 画像穴埋めカード入力 -->
                <StackLayout x:Name="ImageFillLayout"
                             IsVisible="False">
                        <Label Text="画像穴埋め"
                               FontSize="18"/>
                        <Button Text="画像を選択"
                                Clicked="OnSelectImage"/>
                        <skia:SKCanvasView x:Name="CanvasView"
                                           WidthRequest="500"
                                           HeightRequest="300"
                                           IsEnabled="True"
                                           PaintSurface="OnCanvasViewPaintSurface"
                                           EnableTouchEvents="True"
                                           Touch="OnCanvasTouch"/>
                </StackLayout>

                <!-- カードを保存 -->
                <Button Text="カードを保存"
                        Clicked="OnSaveCardClicked"
                        HorizontalOptions="End"
                        VerticalOptions="End"/>

        </VerticalStackLayout>
</ContentPage>
